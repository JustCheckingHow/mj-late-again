<html>

<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="class.css">

    <script>
        var player_x;
        var player_y;

        var local_x;
        var local_y;
        class Map {
            constructor(offset, w) {
                this.mapOffsetX = 50;
                this.mapOffsetY = 50;
            }

        }

        class Player {
            constructor(offset, velocity, w, assigned_div) {
                this.div = assigned_div;

                this.mapOffsetX = 50;
                this.mapOffsetY = 50;
                this.localX = 0;
                this.localY = 0;
                this.d = {};
                this.offset = offset;
                this.velocity = velocity;
                this.w = w;
            }

            newv(n, a, b) {
                if (this.d[a])
                    n -= this.velocity;
                if (this.d[b])
                    n += this.velocity;

                return n
            }

            GetBounds(off) {
                if (off < this.offset) {
                    return this.offset;
                }
                if (off > this.w + this.offset)
                    return this.w + this.offset;

                return off;
            }

            AddVelocity(val, dir) {
                val = parseInt(val, 10);
                if (dir == 0) {
                    var off = this.newv(val, 37, 39);
                    var newX = this.GetBounds(off);
                    if (newX == val)
                        this.mapOffsetX += (val - off);
                    this.localX = newX;
                }
                if (dir == 1) {
                    var off = this.newv(val, 38, 40);
                    var newY = this.GetBounds(off);
                    if (newY == val)
                        this.mapOffsetY += (val - off);
                    this.localY = newY;
                }
            }

            Move() {
                this.div.css({
                    left: function (i, v) {
                        player.AddVelocity(v, 0);
                        return player.localX;
                    },
                    top: function (i, v) {
                        player.AddVelocity(v, 1);
                        return player.localY;
                    }
                });
            }
        }

        let player;
        window.onload = function () {
            var pane = $('#pane'),
                w = (pane.width() - 128) / 3,
                d = {},
                velocity = 3,
                offset = w / 3 * 2;

            player = new Player(offset, velocity, w, $("#box"));


            $(window).keydown(function (e) { player.d[e.which] = true; });
            $(window).keyup(function (e) { player.d[e.which] = false; });

            $(function () {
                setInterval(function () {
                    $('body').css('background-position', player.mapOffsetX + 'px ' + player.mapOffsetY + 'px ');
                    player.Move();

                }, 10);
            })
        }
    </script>
</head>

<body background="img/0.jpg">
    <div id="pane" class="my-auto mx-auto">
        <img id="box" src="img/0.jpg"></img>
    </div>
</body>

</html>